
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>24. Trampolines Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="25-Integer-SIMD.html" />
    
    
    <link rel="prev" href="23-Nested-functions.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Learning Assembly Language with ARM
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="1-Introduction.html">
            
                <a href="1-Introduction.html">
            
                    
                    1. Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="2-Registers-and-Basic-arithmetic.html">
            
                <a href="2-Registers-and-Basic-arithmetic.html">
            
                    
                    2. Registers and Basic arithmetic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="3-Memory-addreses-Load-and-store.html">
            
                <a href="3-Memory-addreses-Load-and-store.html">
            
                    
                    3. Memory, addreses, Load and store
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="4-GDB.html">
            
                <a href="4-GDB.html">
            
                    
                    4. GDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="5-Branches.html">
            
                <a href="5-Branches.html">
            
                    
                    5. Branches
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="6-Control-Structures.html">
            
                <a href="6-Control-Structures.html">
            
                    
                    6. Control Structures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="7-Indexing-modes.html">
            
                <a href="7-Indexing-modes.html">
            
                    
                    7. Indexing modes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="8-Arrays-and-structures.html">
            
                <a href="8-Arrays-and-structures.html">
            
                    
                    8. Arrays and structures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="9-Functions-1.html">
            
                <a href="9-Functions-1.html">
            
                    
                    9. Functions-1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="10-Functions-2-The-stack.html">
            
                <a href="10-Functions-2-The-stack.html">
            
                    
                    10. Functions-2 The stack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="11-Predication.html">
            
                <a href="11-Predication.html">
            
                    
                    11. Predication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="12-Loops-and-the-status-register.html">
            
                <a href="12-Loops-and-the-status-register.html">
            
                    
                    12. Loops and the status register
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="13-Floating-point-numbers.html">
            
                <a href="13-Floating-point-numbers.html">
            
                    
                    13. Floating point numbers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="14-Matrix-multiply.html">
            
                <a href="14-Matrix-multiply.html">
            
                    
                    14. Matrix multiply
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="15-Integer-division.html">
            
                <a href="15-Integer-division.html">
            
                    
                    15. Integer division
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="16-Switch-control-structure.html">
            
                <a href="16-Switch-control-structure.html">
            
                    
                    16. Switch control structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="17-Passing-data-to-functions.html">
            
                <a href="17-Passing-data-to-functions.html">
            
                    
                    17. Passing data to functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="18-Local-data-and-the-frame-pointer.html">
            
                <a href="18-Local-data-and-the-frame-pointer.html">
            
                    
                    18. Local data and the frame pointer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="19-System-calls.html">
            
                <a href="19-System-calls.html">
            
                    
                    19. System calls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="20-Indirect-calls.html">
            
                <a href="20-Indirect-calls.html">
            
                    
                    20. Indirect calls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.21" data-path="21-Subword-data.html">
            
                <a href="21-Subword-data.html">
            
                    
                    21. Subword data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.22" data-path="22-The-Thumb-instruction-set.html">
            
                <a href="22-The-Thumb-instruction-set.html">
            
                    
                    22. The Thumb instruction set
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.23" data-path="23-Nested-functions.html">
            
                <a href="23-Nested-functions.html">
            
                    
                    23. Nested functions
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.24" data-path="24-Trampolines.html">
            
                <a href="24-Trampolines.html">
            
                    
                    24. Trampolines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.25" data-path="25-Integer-SIMD.html">
            
                <a href="25-Integer-SIMD.html">
            
                    
                    25. Integer SIMD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.26" data-path="26-A-primer-about-linking.html">
            
                <a href="26-A-primer-about-linking.html">
            
                    
                    26. A primer about linking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.27" data-path="27-dynamic-linking.html">
            
                <a href="27-dynamic-linking.html">
            
                    
                    27. dynamic-linking
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="appendix.html">
            
                <a href="appendix.html">
            
                    
                    Appendix
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >24. Trampolines</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="24-trampolines">24. Trampolines</h1>
<hr>
<!-- toc -->
<ul>
<li><a href="#sorting-with-nested-function">Sorting with Nested Function</a></li>
<li><a href="#count-how-many-comparisons-happen">Count how many comparisons happen</a></li>
<li><a href="#trampoline">Trampoline</a></li>
<li><a href="#self-modifying-code-%EC%99%80-cache">Self Modifying code &#xC640; Cache</a></li>
<li><a href="#%ED%95%9C%EA%B3%84">&#xD55C;&#xACC4;</a></li>
</ul>
<!-- tocstop -->
<p>&#xC774; &#xC7A5;&#xC5D0;&#xC11C;&#xB3C4; &#xACC4;&#xC18D;&#xD574;&#xC11C; Nested Function&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD55C;&#xB2E4;.  </p>
<h2 id="sorting-with-nested-function">Sorting with Nested Function</h2>
<p>&#xC774;&#xBC88; &#xC7A5;&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xC758; qsort &#xB97C; &#xAD6C;&#xD604;&#xD558;&#xBA74;&#xC11C; pointer&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; nested function &#xC744; &#xAD6C;&#xD604;&#xD574; &#xBCFC; &#xAC83;&#xC774;&#xB2E4;. C&#xB85C;&#xB41C; &#xD568;&#xC218; &#xC6D0;&#xD615;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.    </p>
<pre><code class="lang-c">void qsort(void *base, size_t nmemb, size_t size, int (*compar)(const void *, const void *));
</code></pre>
<p>&#xBA3C;&#xC800; array&#xB97C; print&#xD558;&#xB294; &#xACE8;&#xACA9;&#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xC790;.  </p>
<pre><code class="lang-asm">/* print-array.s */

.data

/* declare an array of 10 integers called my_array */
.align 4
my_array: .word 82, 70, 93, 77, 91, 30, 42, 6, 92, 64

/* format strings for printf */
/* format string that prints an integer plus a space */
.align 4
integer_printf: .asciz &quot;%d &quot;
/* format string that simply prints a newline */
.align 4
newline_printf: .asciz &quot;\n&quot;

.text

print_array:
    /* r0 will be the address of the integer array */
    /* r1 will be the number of items in the array */
    push {r4, r5, r6, lr}  /* keep r4, r5, r6 and lr in the stack */

    mov r4, r0             /* r4 &#x2190;  r0. keep the address of the array */
    mov r5, r1             /* r5 &#x2190;  r1. keep the number of items */
    mov r6, #0             /* r6 &#x2190;  0.  current item to print */

    b .Lprint_array_check_loop /* go to the condition check of the loop */

    .Lprint_array_loop:
      /* prepare the call to printf */
      ldr r0, addr_of_integer_printf  /* r0 &#x2190;  &amp;integer_printf */
      /* load the item r6 in the array in address r4.
         elements are of size 4 bytes so we need to multiply r6 by 4 */
      ldr r1, [r4, +r6, LSL #2]       /* r1 &#x2190;  *(r4 + r6 &lt;&lt; 2)
                                         this is the same as
                                         r1 &#x2190;  *(r4 + r6 * 4) */
      bl printf                       /* call printf */

      add r6, r6, #1                  /* r6 &#x2190;  r6 + 1 */
    .Lprint_array_check_loop: 
      cmp r6, r5               /* perform r6 - r5 and update cpsr */
      bne .Lprint_array_loop   /* if cpsr states that r6 is not equal to r5
                                  branch to the body of the loop */

    /* prepare call to printf */
    ldr r0, addr_of_newline_printf /* r0 &#x2190;  &amp;newline_printf */
    bl printf

    pop {r4, r5, r6, lr}   /* restore r4, r5, r6 and lr from the stack */
    bx lr                  /* return */

addr_of_integer_printf: .word integer_printf
addr_of_newline_printf: .word newline_printf

.globl main
main:
    push {r4, lr}             /* keep r4 and lr in the stack */

    /* prepare call to print_array */
    ldr r0, addr_of_my_array  /* r0 &#x2190;  &amp;my_array */
    mov r1, #10               /* r1 &#x2190;  10
                                 our array is of length 10 */
    bl print_array            /* call print_array */

    mov r0, #0                /* r0 &#x2190;  0 set errorcode to 0 prior returning from main */
    pop {r4, lr}              /* restore r4 and lr in the stack */
    bx lr                     /* return */

addr_of_my_array: .word my_array
</code></pre>
<p>&#xACB0;&#xACFC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB2E8;&#xC21C;&#xD788; &#xBC30;&#xC5F4; contents &#xCD9C;&#xB825;&#xC774;&#xB2E4;.  </p>
<pre><code class="lang-sh"> $ ./<span class="hljs-built_in">print</span>-array 
 82 70 93 77 91 30 42 6 92 64
</code></pre>
<h3 id="comparison">Comparison</h3>
<p>qsort&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xC778;&#xC790;&#xC778; compr &#xD568;&#xC218;
&#xBE44;&#xAD50;&#xD558;&#xB294; &#xD568;&#xC218;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xAD6C;&#xD604;&#xD55C;&#xB2E4;. </p>
<pre><code class="lang-asm">integer_comparison:
    /* r0 will be the address to the first integer */
    /* r1 will be the address to the second integer */
    ldr r0, [r0]    /* r0 &#x2190;  *r0
                       load the integer pointed by r0 in r0 */
    ldr r1, [r1]    /* r1 &#x2190;  *r1
                       load the integer pointed by r1 in r1 */

    cmp r0, r1      /* compute r0 - r1 and update cpsr */
    moveq r0, #0    /* if cpsr means that r0 == r1 then r0 &#x2190;   0 */
    movlt r0, #-1   /* if cpsr means that r0 &lt;  r1 then r0 &#x2190;  -1 */
    movgt r0, #1    /* if cpsr means that r0 &gt;  r1 then r0 &#x2190;   1 */
    bx lr           /* return */
</code></pre>
<blockquote>
<p>11&#xC7A5; predication&#xC744; &#xC774;&#xC6A9;&#xD574; &#xB530;&#xB85C; branch&#xD558;&#xC9C0; &#xC54A;&#xC74C;.  </p>
</blockquote>
<p>qsort&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xAE30; &#xC804;&#xACFC;&#xD6C4; &#xBC30;&#xC5F4; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xCD5C;&#xC885; &#xACE8;&#xACA9; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xB2E4;. </p>
<pre><code class="lang-asm">
.globl main
main:
    push {r4, lr}             /* keep r4 and lr in the stack */

    /* prepare call to print_array */
    ldr r0, addr_of_my_array  /* r0 &#x2190;  &amp;my_array */
    mov r1, #10               /* r1 &#x2190;  10
                                 our array is of length 10 */
    bl print_array            /* call print_array */

    /* prepare call to qsort */
    /*
    void qsort(void *base,
         size_t nmemb,
         size_t size,
         int (*compar)(const void *, const void *));
    */
    ldr r0, addr_of_my_array  /* r0 &#x2190;  &amp;my_array
                                 base */
    mov r1, #10               /* r1 &#x2190;  10
                                 nmemb = number of members
                                 our array is 10 elements long */
    mov r2, #4                /* r2 &#x2190;  4
                                 size of each member is 4 bytes */
    ldr r3, addr_of_integer_comparison
                              /* r3 &#x2190;  &amp;integer_comparison
                                 compar */
    bl qsort                  /* call qsort */

    /* now print again to see if elements were sorted */
    /* prepare call to print_array */
    ldr r0, addr_of_my_array  /* r0 &#x2190;  &amp;my_array */
    mov r1, #10               /* r1 &#x2190;  10
                                 our array is of length 10 */
    bl print_array            /* call print_array */

    mov r0, #0                /* r0 &#x2190;  0 set errorcode to 0 prior returning from main */
    pop {r4, lr}              /* restore r4 and lr in the stack */
    bx lr                     /* return */

addr_of_my_array: .word my_array
addr_of_integer_comparison : .word integer_comparison
</code></pre>
<p>&#xACB0;&#xACFC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC74C;</p>
<pre><code class="lang-sh"> $ ./sort-array 
 82 70 93 77 91 30 42 6 92 64 
 6 30 42 64 70 77 82 91 92 93
</code></pre>
<h2 id="count-how-many-comparisons-happen">Count how many comparisons happen</h2>
<pre><code class="lang-asm">.data
global_counter: .word 0

.text
integer_comparison_count_global:
    /* r0 will be the address to the first integer */
    /* r1 will be the address to the second integer */
    push {r4, r5}   /* keep callee-saved registers */
    ldr r0, [r0]    /* r0 &#x2190;  *r0
                       load the integer pointed by r0 in r0 */
    ldr r1, [r1]    /* r1 &#x2190;  *r1
                       load the integer pointed by r1 in r1 */

    cmp r0, r1      /* compute r0 - r1 and update cpsr */
    moveq r0, #0    /* if cpsr means that r0 == r1 then r0 &#x2190;   0 */
    movlt r0, #-1   /* if cpsr means that r0 &lt;  r1 then r0 &#x2190;  -1 */
    movgt r0, #1    /* if cpsr means that r0 &gt;  r1 then r0 &#x2190;   1 */

    ldr r4, addr_of_global_counter /* r4 &#x2190;  &amp;global_counter */
    ldr r5, [r4]    /* r5 &#x2190;  *r4 */ 
    add r5, r5, #1  /* r5 &#x2190;  r5 + 1 */
    str r5, [r4]    /* *r4 &#x2190;  r5 */

    pop {r4, r5}    /* restore callee-saved registers */
    bx lr           /* return */
addr_of_global_counter: .word global_counter
</code></pre>
<blockquote>
<p>&#xC774; &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C; &#xC608;&#xC81C;&#xB97C; &#xD1B5;&#xD574; nested function&#xC744; &#xC774;&#xC6A9;&#xD574; &#xAD6C;&#xD604;&#xD560; &#xAC83;&#xC774;&#xB2E4;.  </p>
</blockquote>
<p>&#xC9C0;&#xB09C; &#xCC55;&#xD130;&#xC5D0;&#xC11C; nested functions&#xC758; &#xD55C;&#xACC4;&#xC5D0; &#xB300;&#xD574; &#xB9D0;&#xD588;&#xB2E4;. nested functions&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB294; &#xB450; &#xAC00;&#xC9C0;&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;. &#xD568;&#xC218;&#xC758; &#xC8FC;&#xC18C;&#xC640; Lexical scope&#xB2E4;. &#xC77C;&#xB2E8; &#xB2E4;&#xC74C; &#xC5D0;&#xC11C; &#xADF8; &#xD55C;&#xACC4;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xADF9;&#xBCF5;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC790;.     </p>
<h2 id="trampoline">Trampoline</h2>
<p>&#xC774; &#xC7A5;&#xC5D0;&#xC11C;&#xB294; Nested function&#xC744; &#xD568;&#xC218;&#xD3EC;&#xC778;&#xD130;&#xB85C; indirect call &#xD558;&#xC5EC; static link&#xB97C; &#xD1B5;&#xD574; caller&#xD568;&#xC218;(enclosing function)&#xC758; &#xB85C;&#xCEEC;&#xBCC0;&#xC218;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; Access&#xD558;&#xB294;&#xC9C0; &#xBCF4;&#xC5EC;&#xC904; &#xAC83;&#xC774;&#xB2E4;. &#xAC70;&#xAE30;&#xC11C; Stack&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xACE0; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xBA85;&#xB839;&#xC5B4; &#xC9D1;&#xD569;(template)&#xC778; Trampoline&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xAC83;&#xC774;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC778; &#xD568;&#xC218;&#xD3EC;&#xC778;&#xD130;&#xB97C; indirect call &#xD560; &#xB54C;, static link&#xB97C; &#xC54C;&#xC544;&#xC11C; &#xC124;&#xC815;&#xD574;&#xC8FC;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xADF8;&#xAC83;&#xC744; &#xB300;&#xC2E0;&#xD574;&#xC8FC;&#xB294; trampoline&#xCF54;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.   </p>
<p><code>&#xCC38;&#xACE0;: trampoline &#xC774;&#xB780;</code></p>
<blockquote>
<p><a href="https://gcc.gnu.org/onlinedocs/gccint/Trampolines.html" target="_blank">gcc doc: Trampolines</a>
A trampoline is a small piece of code that is created at run time when the address of a nested function is taken. It normally resides on the stack, in the stack frame of the containing function. These macros tell GCC how to generate code to allocate and initialize a trampoline.<br>The instructions in the trampoline must do two things: load a constant address into the static chain register, and jump to the real address of the nested function.   </p>
</blockquote>
<p>&#xC9C0;&#xB09C; &#xCC55;&#xD130;&#xC5D0;&#xC11C; &#xBCF8; &#xC608;&#xC81C;&#xCC98;&#xB7FC; <code>r10</code>&#xB294; &#xD568;&#xC218; &#xC9C4;&#xC785;&#xC2DC; Lexical scope(Static link)&#xB97C; &#xAC16;&#xAC8C; &#xB41C;&#xB2E4;. &#xD568;&#xC218;&#xB85C; branch&#xB97C; &#xD560;&#xB54C; r10&#xAC12;&#xC744; &#xBBF8;&#xB9AC; &#xC14B;&#xD305;&#xD574; &#xC8FC;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; qsort&#xB97C; &#xD638;&#xCD9C;&#xD560;&#xB54C;&#xB294; &#xADF8;&#xB807;&#xC9C0; &#xBABB;&#xD558;&#xB2E4;. qsort&#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xD568;&#xC218;&#xD3EC;&#xC778;&#xD130; (*compar) &#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C;, r10 (static link)&#xB97C; &#xC800;&#xC7A5;&#xD55C;&#xB4A4; &#xD568;&#xC218;&#xB85C; jump&#xD558;&#xB294; &#xB3D9;&#xC791;&#xC744; &#xC2A4;&#xC2A4;&#xB85C; &#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xBB34;&#xC5B8;&#xAC00;&#xAC00; &#xC774;&#xB3D9;&#xC791;&#xC744; &#xB300;&#xC2E0; &#xD574;&#xC918;&#xC57C;&#xD558;&#xB294;&#xB370; &#xC774; &#xCF54;&#xB4DC;&#xB97C; Trampoline &#xC774;&#xB77C;&#xACE0; &#xD55C;&#xB2E4;. </p>
<p>Trampoline&#xC740; &#xB2E8;&#xC21C;&#xD55C; &#xBAA9;&#xC801;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB2E4;. &#xD56D;&#xC0C1; &#xB2E4;&#xC74C;&#xC758; &#xB3D9;&#xC791;&#xB9CC; &#xD55C;&#xB2E4;.
1) r10&#xC744; &#xC124;&#xC815;<br>2) Nested &#xD568;&#xC218;&#xB97C; Indirect Call   </p>
<pre><code class="lang-asm">.Laddr_trampoline_template : .word .Ltrampoline_template /* we will use this below */
.Ltrampoline_template:
    .Lfunction_called: .word 0x0     /* &#xD6C4;&#xC5D0; &#xC774; &#xCF54;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xC801;&#xC808;&#xD558;&#xAC8C; set&#xB420; &#xB77C;&#xC778; */
    .Llexical_scope: .word 0x0       /* &#xD6C4;&#xC5D0; &#xC774; &#xCF54;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xC801;&#xC808;&#xD558;&#xAC8C; set&#xB420; &#xB77C;&#xC778; */
    push {r4, r5, r10, lr}           /* keep callee-saved registers */
    ldr r4, .Lfunction_called        /* r4 &#x2190;  function called */
    ldr r10, .Llexical_scope         /* r10 &#x2190;  lexical scope */
    blx r4                           /* indirect call to r4 */
    pop {r4, r5, r10, lr}            /* restore callee-saved registers */
    bx lr                            /* return */
</code></pre>
<blockquote>
<p>&#xCD1D; 8&#xAC1C;&#xC758; &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9D0;. 4x8 == 32bytes</p>
</blockquote>
<p>&#xB2E4;&#xC74C;&#xBD80;&#xD130; &#xB098;&#xC624;&#xB294; &#xCF54;&#xB4DC; &#xC870;&#xAC01;(snippet)&#xC740; &#xB3D9;&#xC77C;&#xD55C; &#xD30C;&#xC77C;&#xC744; &#xB098;&#xB220;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xAC83;&#xC774;&#xB2E4; </p>
<pre><code class="lang-asm">.globl main
main:
    push {r4, r5, r6, fp, lr} /* keep callee saved registers */
    mov fp, sp                /* setup dynamic link */

    sub sp, sp, #4            /* counter will be in fp - 4 */
    /* note that now the stack is 8-byte aligned */

    /* set counter to zero */
    mov r4, #0        /* r4 &#x2190;  0 */
    str r4, [fp, #-4] /* counter &#x2190;  r4 */
</code></pre>
<blockquote>
<p>main &#xD568;&#xC218; &#xC2DC;&#xC791; &#xBD80;&#xBD84;</p>
</blockquote>
<pre><code class="lang-asm">    /* Make room for the trampoline */
    sub sp, sp, #32 /* sp &#x2190;  sp - 32 */
    ^^^^^^^^^^^^^^^
    /* note that 32 is a multiple of 8, so the stack
       is still 8-byte aligned */
</code></pre>
<blockquote>
<p>&#xADF8; &#xB4A4; Tempoline &#xCF54;&#xB4DC;&#xB97C; &#xC2A4;&#xD0DD;&#xC5D0; &#xB123;&#xAE30; &#xC704;&#xD574; &#xACF5;&#xAC04; &#xD560;&#xB2F9;&#xD55C;&#xB2E4;. Tempoline &#xC740; &#xC2A4;&#xD0DD;&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xB294; code&#xC774;&#xB2E4;.  </p>
</blockquote>
<pre><code class="lang-asm">    /* copy the trampoline into the stack */
    mov r4, #32                        /* r4 &#x2190;  32 */
    ldr r5, .Laddr_trampoline_template /* r4 &#x2190;  &amp;trampoline_template */
    mov r6, sp                         /* r6 &#x2190;  sp */
    b .Lcopy_trampoline_loop_check     /* branch to copy_trampoline_loop_check */

    .Lcopy_trampoline_loop:
        ldr r7, [r5]     /* r7 &#x2190;  *r5 */ // trampoline &#xCF54;&#xB4DC;&#xB97C; 4byte&#xC529; &#xAC00;&#xC838;&#xC634;
        ^^^^^^^^^^^^
        str r7, [r6]     /* *r6 &#x2190;  r7 */ // Stack&#xC5D0; 4byte&#xC529; &#xC800;&#xC7A5; 
        ^^^^^^^^^^^^
        add r5, r5, #4   /* r5 &#x2190;  r5 + 4 */
        add r6, r6, #4   /* r6 &#x2190;  r6 + 4 */
        sub r4, r4, #4   /* r4 &#x2190;  r4 - 4 */
    .Lcopy_trampoline_loop_check:
        cmp r4, #0                  /* compute r4 - 0 and update cpsr */
        bgt .Lcopy_trampoline_loop  /* if cpsr means that r4 &gt; 0
                                       then branch to copy_trampoline_loop */
</code></pre>
<blockquote>
<p>&#xADF8; &#xB4A4; trampoline &#xC744; stack&#xC73C;&#xB85C; copy  </p>
</blockquote>
<p>Setup the trampoline:  </p>
<pre><code class="lang-asm">    /* setup the trampoline */
    ldr r4, addr_of_integer_comparison_count
                                  /* r4 &#x2190;  &amp;integer_comparison_count */
    str r4, [fp, #-36]            /* *(fp - 36) &#x2190;  r4 */ // &#xD568;&#xC218;&#xD3EC;&#xC778;&#xD130;
                                  /* set the function_called in the trampoline
                                     to be &amp;integer_comparison_count */
    str fp, [fp, #-32]            /* *(fp - 32) &#x2190;  fp */ // Static Link
                                  /* set the lexical_scope in the trampoline to be fp */
</code></pre>
<blockquote>
<p>.Lfunction_called: .word 0x0 -&gt; <code>str r4, [fp, #-36]</code> 
.Llexical_scope: .word 0x0 -&gt; <code>str fp, [fp, #-32]</code><br>trampoline &#xCF54;&#xB4DC;&#xC758; &#xC0C1;&#xC704; &#xB450; &#xB77C;&#xC778;&#xC774;&#xB2E4;.<br>&#xC704;&#xC758; &#xC608;&#xC81C;&#xC5D0;&#xC11C; 8&#xAC1C;&#xC758; trampoline &#xBA85;&#xB839;&#xC5B4;&#xC5D0;&#xC11C; &#xC0C1;&#xC704; &#xB450;&#xB77C;&#xC778;&#xAE4C;&#xC9C0;&#xB294; &#xC5B4;&#xB5A0;&#xD55C; &#xAC12;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC57C; &#xD588;&#xB2E4;. &#xB2E4;&#xC74C; &#xCF54;&#xB4DC;&#xB294; &#xCCAB;&#xBC88;&#xC9F8;, &#xB450;&#xBC88;&#xC9F8; &#xB0B4;&#xC6A9;&#xC744; &#xC124;&#xC815;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xC774;&#xB2E4;.<br>&#xCCAB;&#xBC88;&#xC9F8; 4&#xBC14;&#xC774;&#xD2B8;&#xB294; &#xD638;&#xCD9C;&#xD560; integer_comparision_count&#xC758; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xC774;&#xB2E4;.<br>&#xB450;&#xBC88;&#xC9F8; 4&#xBC14;&#xC774;&#xD2B8;&#xB294; Static Link&#xC774;&#xB2E4;.<br>&#xC774; &#xCF54;&#xB4DC; &#xC218;&#xD589;&#xD6C4; cache flush&#xB97C; &#xD55C;&#xB2E4;. (&#xC774; &#xC7A5;(24) &#xB9E8;&#xC544;&#xB798;&#xCC55;&#xD130; &#xCC38;&#xACE0;)  </p>
</blockquote>
<pre><code class="lang-asm">   /* prepare call to print_array */
    ldr r0, addr_of_my_array /* r0 &#x2190;  &amp;my_array */
    mov r1, #10              /* r1 &#x2190;  10
                                our array is of length 10 */
    bl print_array           /* call print_array */

    /* prepare call to qsort */
    /*
    void qsort(void *base,
         size_t nmemb,
         size_t size,
         int (*compar)(const void *, const void *));
    */
    ldr r0, addr_of_my_array /* r0 &#x2190;  &amp;my_array base */
    mov r1, #10              /* r1 &#x2190;  10
                                nmemb = number of members
                                our array is 10 elements long */
    mov r2, #4               /* r2 &#x2190;  4
                                size of each member is 4 bytes */
    sub r3, fp, #28          /* r3 &#x2190;  fp - 28 */
    ^^^^^^^^^^^^^^^          /* &#xCC38;&#xACE0;&#xB85C; tempoline&#xC758; 3&#xBC88;&#xC9F8; &#xBC14;&#xC774;&#xD2B8;: &#xCF54;&#xB4DC;&#xC758; &#xC2DC;&#xC791;&#xC704;&#xCE58;&#xC774;&#xB2E4;. */
    bl qsort                 /* call qsort */

    /* prepare call to printf */
    ldr r1, [fp, #-4]                    /* r1 &#x2190;  counter */
    ldr r0, addr_of_comparison_message   /* r0 &#x2190;  &amp;comparison_message */
    bl printf                            /* call printf */

    /* now print again the array to see if elements were sorted */
    /* prepare call to print_array */
    ldr r0, addr_of_my_array  /* r0 &#x2190;  &amp;my_array */
    mov r1, #10               /* r1 &#x2190;  10
                                 our array is of length 10 */
    bl print_array            /* call print_array */
</code></pre>
<blockquote>
<p>qsort&#xC758; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB97C; r0 ~ r3 &#xC5D0; &#xC800;&#xC7A5;&#xD55C; &#xB4A4; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;.<br><code>sub r3, fp, #28</code> : &#xC989; &#xD568;&#xC218;&#xD3EC;&#xC778;&#xD130; integer_comparision_count &#xB97C; &#xC9C1;&#xC811;&#xD638;&#xCD9C; &#xD558;&#xB294;&#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C;, &#xADF8; &#xC0AC;&#xC774;&#xC5D0; &#xB2E4;&#xB978; &#xBCF4;&#xC870;&#xD568;&#xC218; tempoline&#xC774; &#xB300;&#xC2E0; Indirect Call &#xC2DC;&#xCF1C;&#xC8FC;&#xB294; &#xAC83;&#xC774;&#xB2E4;.<br>fp - 28&#xC740; tempoline&#xC758; &#xC138;&#xBC88;&#xC9F8; 4&#xBC14;&#xC774;&#xD2B8; &#xC989;,  &#xC2DC;&#xC791; &#xCF54;&#xB4DC;&#xAC00; &#xC704;&#xCE58;&#xD55C; &#xC8FC;&#xC18C;&#xC774;&#xB2E4;.  </p>
</blockquote>
<pre><code class="lang-asm">    /* nested function integer comparison */
    addr_of_integer_comparison_count : .word integer_comparison_count
    integer_comparison_count:
        /* r0 will be the address to the first integer */
        /* r1 will be the address to the second integer */
        push {r4, r5, r10, fp, lr} /* keep callee-saved registers */
        mov fp, sp                 /* setup dynamic link */

        ldr r0, [r0]    /* r0 &#x2190;  *r0
                           load the integer pointed by r0 in r0 */
        ldr r1, [r1]    /* r1 &#x2190;  *r1
                           load the integer pointed by r1 in r1 */

        cmp r0, r1      /* compute r0 - r1 and update cpsr */
        moveq r0, #0    /* if cpsr means that r0 == r1 then r0 &#x2190;   0 */
        movlt r0, #-1   /* if cpsr means that r0 &lt;  r1 then r0 &#x2190;  -1 */
        movgt r0, #1    /* if cpsr means that r0 &gt;  r1 then r0 &#x2190;   1 */

        ldr r4, [fp, #8]  /* r4 &#x2190;  *(fp + 8)
        ^^^^^^^^^^^^^^^^^  get static link in the stack */
        ldr r5, [r4, #-4] /* r5 &#x2190;  counter
        ^^^^^^^^^^^^^^^^^  main &#xD568;&#xC218;&#xC758; &#xB85C;&#xCEEC;&#xBCC0;&#xC218;&#xB97C; &#xC5BB;&#xC5B4;&#xC634;!
                             get value of counter */
        add r5, r5, #1    /* r5 &#x2190;  r5 + 1 */
        str r5, [r4, #-4] /* counter &#x2190;  r5
                             update counter */

        mov sp, fp        /* restore stack */
        pop {r4, r5, r10, fp, lr} /* restore callee-saved registers */
        bx lr           /* return */
</code></pre>
<blockquote>
<p>&#xADF8; Nested function&#xC740; &#xC704;&#xC640; &#xAC19;&#xB2E4;.
 *compar&#xC758; &#xD568;&#xC218;&#xD3EC;&#xC778;&#xD130;&#xB294; &#xC774; &#xD568;&#xC218;&#xB97C; &#xAC00;&#xB9AC;&#xD0A8;&#xB2E4;. tempoline&#xC740; &#xC774;&#xD568;&#xC218;&#xB97C; indirect call&#xD574;&#xC900;&#xB2E4;. &#xD575;&#xC2EC;&#xC740; &#xC774; &#xD568;&#xC218;&#xAC00; &#xD568;&#xC218;&#xD3EC;&#xC778;&#xD130;&#xB97C; &#xD1B5;&#xD574; indirect call &#xB41C; nested function&#xC784;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; enclosing function&#xC778; main: &#xC758; &#xB85C;&#xCEEC;&#xBCC0;&#xC218;&#xB97C; Access &#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC774;&#xB2E4;. &#xC774;&#xAC83;&#xC774; &#xC774; &#xC7A5;&#xC758; &#xD575;&#xC2EC;&#xC774;&#xB2E4;.   </p>
</blockquote>
<p>&#xC774;&#xB807;&#xAC8C; Indirect call&#xB41C; nested function&#xC774; static link&#xB97C; &#xC815;&#xD655;&#xD558;&#xAC8C; &#xAC00;&#xC838;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD560;&#xC218; &#xC788;&#xB2E4;. &#xC774;&#xAC83;&#xC774; trampoline&#xC758; &#xD558;&#xB294; &#xC77C;&#xC774;&#xB2E4;. </p>
<h2 id="self-modifying-code-&#xC640;-cache">Self Modifying code &#xC640; Cache</h2>
<p>&#xC0AC;&#xC2E4; &#xC704;&#xC758; &#xC608;&#xC81C;&#xB294; &#xC77C;&#xC885;&#xC758; Self Modifying code &#xC774;&#xB2E4;. </p>
<p>Raspberry PI&#xC758; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xB294; modified harvard architecture&#xC778;&#xB370;, &#xC774;&#xAC83;&#xC740; instruction memory(.text) &#xC640; data memory(.data)&#xB97C; &#xAD6C;&#xBD84;&#xD574;&#xC11C; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;. &#xC774;&#xAC83;&#xC740; &#xC11C;&#xB85C;&#xB2E4;&#xB978; cache&#xAC00; &#xD544;&#xC694;&#xD568;&#xC744; &#xC758;&#xBBF8;&#xD55C;&#xB2E4;. Instruction Cache &#xC640; Data Cache &#xC774;&#xB2E4;.   </p>
<p>&#xBA85;&#xB839;&#xC5B4; &#xCE90;&#xC2DC;&#xB294; data&#xCE90;&#xC2DC;&#xC758; &#xAC12;&#xC744; &#xC5BB;&#xC5B4;&#xC62C;&#xC218; &#xC5C6;&#xB2E4;.  &#xBA85;&#xB839;&#xC5B4; &#xCE90;&#xC2DC;&#xB294; &#xB370;&#xC774;&#xD130;&#xB97C; main memory&#xC5D0;&#xC11C;&#xBC16;&#xC5D0; &#xC5BB;&#xC5B4;&#xC62C;&#xC218; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; data &#xCE90;&#xC2DC;&#xC5D0; &#xAE30;&#xB85D;&#xD55C; &#xBAA8;&#xB4E0; &#xC218;&#xC815;&#xC0AC;&#xD56D;&#xC744; main memory&#xC5D0; update  &#xD574;&#xC57C;&#xD55C;&#xB2E4;. &#xC774;&#xAC83;&#xC744; Flushing the Cache &#xB77C;&#xACE0; &#xD55C;&#xB2E4;.<br>(Conversely, since the instruction cache will only get data from the main memory (and not from the data cache), we need to write back all the changes we did in the data cache to the main memory (this is called flushing the cache))  </p>
<blockquote>
<p>Write Back: Data&#xB97C; &#xC4F8; &#xB54C; Memory&#xC5D0;&#xB294; &#xC548; &#xC4F0;&#xACE0;, Cache&#xB9CC; update&#xD558;&#xB294; &#xBC29;&#xBC95;</p>
</blockquote>
<pre><code>Data --------------&gt; Data cache --------------&gt; memory
        write back                    flush
</code></pre><p>&#xB2E4;&#xC2DC;&#xB9D0;&#xD558;&#xBA74;, &#xCE90;&#xC2DC; write back&#xC744;&#xD558;&#xBA74; data cache&#xC5D0;&#xB9CC; &#xC4F0;&#xACE0; &#xC2E4;&#xC81C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xB294; write&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB370;, &#xC774;&#xB54C; memory&#xC640; cache&#xC5D0; inconsistancy&#xAC00; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; write&#xD574;&#xC918;&#xC57C; &#xD558;&#xB294;&#xB370; &#xC774;&#xAC83;&#xC744; &#xC5EC;&#xAE30;&#xC120; Flushing the cache&#xB77C;&#xACE0; &#xBD80;&#xB978;&#xB2E4;. (&#xC5B4;&#xB5A4; &#xC790;&#xB8CC;&#xB294; &#xC774;&#xAC83;&#xC744; cache clean&#xC774;&#xB77C;&#xACE0; &#xBD80;&#xB974;&#xB358;&#xB370; &#xBB50;&#xAC00; &#xB9DE;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD544;&#xC694; : <a href="http://recipes.egloos.com/5170809" target="_blank">http://recipes.egloos.com/5170809</a>)</p>
<p>ARM &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xC774; Flushing the Cache &#xB3D9;&#xC791;&#xC740; privileged operation&#xC774;&#xB2E4;. &#xC774;&#xAC83;&#xC740; coprocessor &#xBA85;&#xB839;&#xC5B4; coprocessor 15 &#xB97C; &#xC774;&#xC6A9;&#xD55C;&#xB2E4;. &#xC774; &#xB73B;&#xC740; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xAC00; &#xC774; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xB73B;&#xC774;&#xB2E4;. &#xB9AC;&#xB205;&#xC2A4; &#xCEE4;&#xB110;&#xC740; <code>cacheflush</code> &#xB77C;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xCF5C;&#xC744; &#xC81C;&#xACF5;&#xD55C;&#xB2E4;.  </p>
<p>19&#xC7A5;&#xC5D0;&#xC11C; &#xC0B4;&#xD3B4;&#xBD24;&#xB358;&#xAC83; &#xCC98;&#xB7FC; &#xC2DC;&#xC2A4;&#xD15C;&#xCF5C;&#xC740; <code>swi</code>&#xBA85;&#xB839;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. r0&#xB294; flush&#xD574;&#xC57C;&#xD560; &#xC601;&#xC5ED;&#xC758; &#xC2DC;&#xC791;&#xC8FC;&#xC18C;&#xAC00; &#xC788;&#xC5B4;&#xC57C; &#xD558;&#xACE0;, r1&#xC740;  must contain the address of the first byte that will not be invalidated. r2&#xB294; 0&#xC774;&#xC5B4;&#xC57C; &#xD558;&#xACE0;, &#xC2DC;&#xC2A4;&#xD15C;&#xCF5C;&#xC758; &#xAD6C;&#xBD84; &#xCF54;&#xB4DC; r7&#xC740; 0xF0002 &#xC774;&#xB2E4;.   </p>
<pre><code class="lang-asm">    push {r7}          /* keep r7 because we are going to modify it */
    mov r7, #0xf0000   /* r7 &#x2190;  0xf0000 */
    add r7, r7, #2     /* r7 &#x2190;  r7 + 2. So r7 &#x2190;  0xf0002
                          We do this in two steps because
                          we cannot encode 0xf0002 in
                          the instruction */
    mov r0, sp         /* r0 &#x2190;  sp */
    add r1, sp, #32    /* r1 &#x2190;  sp + 32 */
    mov r2, #0         /* r2 &#x2190;  0 */
    swi 0              /* system call */
    ^^^^^
    pop  {r7}          /* restore r7 */
</code></pre>
<p>libgcc&#xC5D0;&#xB294; __clear_cache &#xD568;&#xC218;&#xAC00; &#xC788;&#xAE30;&#xB3C4; &#xD558;&#xB2E4;.  </p>
<pre><code class="lang-asm">    /* prepare call to __clear_cache */
    mov r0, sp       /* r0 &#x2190;  sp */
    add r1, sp, #32  /* r1 &#x2190;  sp + 32 */
    bl __clear_cache /* call __clear_cache */
</code></pre>
<p>&#xC774; code&#xB97C; tempoline &#xC744; &#xC124;&#xC815;&#xD55C;&#xB4A4;&#xC5D0; &#xBC14;&#xB85C; &#xC218;&#xD589;&#xD574;&#xC57C;&#xD55C;&#xB2E4;. </p>
<p>&#xC804;&#xCCB4; &#xCF54;&#xB4DC;&#xB294; <a href="https://github.com/rofirrim/raspberry-pi-assembler/blob/master/chapter24/trampoline-sort-array.s" target="_blank">Full source</a> &#xC5D0;&#xC11C; &#xD655;&#xC778; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;.  </p>
<h2 id="&#xD55C;&#xACC4;">&#xD55C;&#xACC4;</h2>
<p>&#xB300;&#xBD80;&#xBD84;&#xC758; modern &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; readable/writable/executable&#xB85C; &#xAD6C;&#xBD84;&#xD558;&#xB294;&#xB370; stack &#xC774;&#xB098; .data &#xB294; &#xBCF4;&#xD1B5; executable &#xD558;&#xC9C0;&#xC54A;&#xB2E4;. &#xC624;&#xC9C1; .text &#xC601;&#xC5ED;&#xB9CC; executable &#xD558;&#xB2E4;. &#xC6B0;&#xB9AC;&#xB294; executable stack&#xC744; &#xC0AC;&#xC6A9;&#xD588;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xBC88;&#xC7A5;&#xC758; &#xC608;&#xC81C;&#xAC00; &#xAC00;&#xB2A5;&#xD588;&#xB358; &#xAC83;&#xC774;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; executable stack &#xC740; buffer overflows&#xAC19;&#xC740; &#xD574;&#xD0B9;&#xB4F1;&#xC5D0; &#xCDE8;&#xC57D;&#xD558;&#xB2E4;.</p>
<p>23&#xC7A5; 24&#xC7A5;&#xC5D0;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF8;&#xAC83; &#xCC98;&#xB7FC; Nested function&#xC740; &#xC5EC;&#xB7EC; &#xB2E8;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xB9CE;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC5B8;&#xC5B4;&#xAC00; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xBC30;&#xACBD;&#xC77C;&#xAC83;&#xC774;&#xB2E4;.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="23-Nested-functions.html" class="navigation navigation-prev " aria-label="Previous page: 23. Nested functions">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="25-Integer-SIMD.html" class="navigation navigation-next " aria-label="Next page: 25. Integer SIMD">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"24. Trampolines","level":"2.24","depth":1,"next":{"title":"25. Integer SIMD","level":"2.25","depth":1,"path":"markdowns/25-Integer-SIMD.md","ref":"markdowns/25-Integer-SIMD.md","articles":[]},"previous":{"title":"23. Nested functions","level":"2.23","depth":1,"path":"markdowns/23-Nested-functions.md","ref":"markdowns/23-Nested-functions.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{"BASE_URL":"http://soopsaram.com/assembly"},"plugins":["ga","simple-page-toc","disqus","back-to-top-button","edit-link","github"],"pluginsConfig":{"disqus":{"useIdentifier":false,"shortName":"jihuun"},"github":{"url":"https://github.com/jihuun/assembly"},"simple-page-toc":{"maxDepth":2,"skipFirstH1":true},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"back-to-top-button":{},"ga":{"configuration":"auto","token":"UA-145847458-1"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit","base":"https://github.com/jihuun/assembly/edit/master"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"markdowns/24-Trampolines.md","mtime":"2020-05-14T21:35:13.436Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-05-14T21:35:53.272Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

